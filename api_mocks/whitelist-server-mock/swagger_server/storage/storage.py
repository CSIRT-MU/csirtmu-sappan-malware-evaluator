import json

from ..models.record import Record


class Storage:
    whitelist = '/usr/src/app/data/whitelist.json'

    def save_db(self, data):
        db = self.get_db()
        with open(self.whitelist, "w") as db:
            json.dump(data, db)

    def get_records(self):
        with open(self.whitelist, "r") as db:
            try:
                return json.load(db)
            except:
                print('Error opening storage file')
                return False


    def create_record(self, record: Record):
        new_record = record.as_dict()
        data = self.get_db()
        if not data:
            return False
        self.save_db(data)
        return new_record
