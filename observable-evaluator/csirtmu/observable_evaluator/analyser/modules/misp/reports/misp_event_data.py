from dataclasses import dataclass
from dataclasses_json import dataclass_json
from dataclasses_json.undefined import Undefined
from typing import Any, List

from .misp_attribute import MISPAttribute
from .misp_org import MISPOrg
from .misp_object import MISPObject


@dataclass_json(undefined=Undefined.EXCLUDE)
@dataclass
class MISPEventData:
    id: str
    Org: MISPOrg
    Orgc: MISPOrg
    date: str
    info: str
    uuid: str
    Galaxy: List[Any]
    Object: List[MISPObject]
    locked: bool
    org_id: str
    orgc_id: str
    analysis: str
    Attribute: List[MISPAttribute]
    published: bool
    timestamp: str
    EventReport: List[Any]
#    RelatedEvent <-- this is insane redundancy
    distribution: str
    extends_uuid: str
    ShadowAttribute: List[Any]
    attribute_count: str
    threat_level_id: str
    sharing_group_id: str
    publish_timestamp: str
    disable_correlation: bool
    event_creator_email: str
    proposal_email_lock: bool
