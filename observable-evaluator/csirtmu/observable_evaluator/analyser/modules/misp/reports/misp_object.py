from dataclasses import dataclass, field
from dataclasses_json import dataclass_json, config
from dataclasses_json.undefined import Undefined
from typing import List, Any, Optional

from .misp_attribute import MISPAttribute


@dataclass_json(undefined=Undefined.EXCLUDE)
@dataclass
class MISPObject:
    id: str
    name: str
    uuid: str
    comment: str
    deleted: bool
    event_id: str
    template_version: str
    ObjectReference: List[Any]
    template_uuid: str
    description: str
    last_seen: Optional[str]
    first_seen: Optional[str]
    timestamp: str
    distribution: str
    meta_category: str = field(metadata=config(field_name="meta-category"))
    Attribute: List[MISPAttribute]
