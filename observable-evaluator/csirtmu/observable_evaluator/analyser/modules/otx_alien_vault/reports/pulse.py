from typing import List, Dict, Any, Optional
from dataclasses import dataclass, field
from dataclasses_json import dataclass_json
from dataclasses_json.undefined import Undefined

from csirtmu.observable_evaluator.analyser.modules.otx_alien_vault.reports.malware_family import MalwareFamily


@dataclass_json(undefined=Undefined.EXCLUDE)
@dataclass
class Pulse:

    id: Optional[str]
    TLP: Optional[str]
    name: Optional[str]
    tags: Optional[List[str]]
    vote: Optional[int]
    author: Optional[Dict[str, Any]]
    locked: Optional[bool]
    public: Optional[int]
    created: Optional[str]
    modified: Optional[str]
    targeted_countries: Optional[List[str]]
    malware_families: Optional[List[MalwareFamily]] = None
