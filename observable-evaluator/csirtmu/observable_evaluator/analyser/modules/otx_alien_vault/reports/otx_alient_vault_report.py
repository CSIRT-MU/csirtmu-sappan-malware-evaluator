from typing import List, Optional, Dict, Any
from dataclasses import dataclass, field
from dataclasses_json import dataclass_json
from dataclasses_json.undefined import Undefined

from .otx_passivedns import OTXPassiveDNS
from .pulse import Pulse
from .otx_analysis import OTXAnalysis


@dataclass_json(undefined=Undefined.EXCLUDE)
@dataclass()
class OTXAlienVaultReport():
    reputation: Optional[str] = None
    malware_samples: List[str] = field(default_factory=lambda: [])
    url_list: List[Any] = field(default_factory=lambda: [])
    passive_dns: List[OTXPassiveDNS] = field(default_factory=lambda: [])
    pulses: List[Pulse] = field(default_factory=lambda: [])
    geo: Dict[str, Any] = field(default_factory=lambda: {})
    analysis: OTXAnalysis = field(default_factory=lambda: {})
