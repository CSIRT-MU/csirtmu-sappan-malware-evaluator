from csirtmu.observable_evaluator.analyser.modules.google_safebrowsing import GoogleSafebrowsingObservableAnalyser
from csirtmu.observable_evaluator.analyser.modules.cloudflare import CloudflareObservableAnalyser
from csirtmu.observable_evaluator.analyser.modules.otx_alien_vault import OTXAlienVaultObservableAnalyser, OTXAlienVaultFileAnalyser
from csirtmu.observable_evaluator.analyser.modules.virustotal import VirusTotalObservableAnalyser, VirusTotalFileAnalyser
from csirtmu.observable_evaluator.analyser.modules.hybrid_analysis import HybridAnalysisObservableAnalyser, HybridAnalysisFileAnalyser
from csirtmu.observable_evaluator.analyser.modules.misp import MISPObservableAnalyser, MISPFileAnalyser


class IntelOwlAnalyserFactory:
    mapping = {
        "VirusTotal_v3_Get_File_And_Scan": VirusTotalFileAnalyser,
        "VirusTotal_v3_Get_Observable": VirusTotalObservableAnalyser,
        "HybridAnalysis_Get_File": HybridAnalysisFileAnalyser,
        "HybridAnalysis_Get_Observable": HybridAnalysisObservableAnalyser,
        "OTX_Check_Hash": OTXAlienVaultFileAnalyser,
        "OTXQuery": OTXAlienVaultObservableAnalyser,
        "GoogleSafebrowsing": GoogleSafebrowsingObservableAnalyser,
        "CloudFlare_Malicious_Detector": CloudflareObservableAnalyser,
        "MISP": MISPObservableAnalyser,
        "MISP_Check_Hash": MISPFileAnalyser
    }

    @classmethod
    def get_analyser(cls, tool_name: str):
        return cls.mapping[tool_name]()
