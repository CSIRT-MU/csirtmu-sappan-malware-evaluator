from starlette.routing import Route, Mount, WebSocketRoute
from csirtmu.observable_evaluator.endpoints import check_files,check_observables
from csirtmu.observable_evaluator.schema import schema
from strawberry.asgi import GraphQL

graphql_app = GraphQL(schema)

routes = [
    Mount('/', routes=[
        Route('/graphql', graphql_app),
        WebSocketRoute('/graphql', graphql_app),
        Route('/analyse_files', endpoint=check_files, methods=["GET", "POST"]),
        Route('/analyse_observables', endpoint=check_observables, methods=["GET", "POST"])
    ])
]
