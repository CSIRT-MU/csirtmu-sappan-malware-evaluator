from airflow.models import BaseOperator
from airflow.utils.decorators import apply_defaults
from airflow.operators.dagrun_operator import TriggerDagRunOperator
from external_services.dnsrpz.block_multiple_domains import block_multiple_domains

class DNSRPZTriggerMultipleOperator(BaseOperator):
    template_fields=('data', 'arbitrary')
    @apply_defaults
    def __init__(
            self,
            data,
            arbitrary="",
            **kwargs) -> None:
        super().__init__(**kwargs)
        self.data = data
        self.arbitrary =arbitrary

    def execute(self, context):
        dag = block_multiple_domains()
        trigger_dag = TriggerDagRunOperator(
            task_id='trigger_dnsrpz_block',
            trigger_dag_id=dag.dag_id,
            conf=self.data
        )
        trigger_dag.execute(context)

        